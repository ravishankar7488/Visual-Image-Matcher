<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Similar Images</title>

    <!-- ✅ Bootstrap CSS -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />

    <style>
      body {
        background-color: #f8f9fa;
      }
      .banner-img {
        width: 100%;
        max-height: 250px;
        object-fit: cover;
      }
      .footer {
        text-align: center;
        margin-top: 40px;
        padding: 20px;
        color: #6c757d;
        background-color: #e9ecef;
      }
      .note-box {
        background-color: #fff3cd;
        border-left: 5px solid #ffeeba;
        padding: 15px 20px;
        border-radius: 8px;
        margin-top: 20px;
        margin-bottom: 20px;
      }
      .buy-sell-link {
        display: inline-block;
        background-color: #0d6efd;
        color: white;
        padding: 10px 20px;
        border-radius: 50px;
        text-decoration: none;
        font-weight: bold;
        transition: background-color 0.3s ease, transform 0.2s ease;
      }
      .buy-sell-link:hover {
        background-color: #084298;
        transform: scale(1.05);
        text-decoration: none;
      }
      @media (max-width: 768px) {
        .banner-img {
          max-height: 180px;
        }
      }
    </style>
  </head>
  <body>
    <!-- ✅ Banner Section -->
    <header>
      <img
        src="https://images.unsplash.com/photo-1519389950473-47ba0277781c?auto=format&fit=crop&w=1600&q=80"
        alt="Results Banner"
        class="banner-img"
      />
    </header>

    <div class="container mt-5 mb-5">
      <h1 class="text-center mb-4">Similar Images</h1>

      <% if (results.length === 0) { %>
      <div class="alert alert-warning text-center" role="alert">
        No similar images found.
      </div>
      <% } else { %>
      <div class="row row-cols-1 row-cols-sm-2 row-cols-md-3 g-4">
        <% results.forEach(hit => { %>
        <div class="col">
          <div class="card h-100 shadow-sm">
            <img
              src="<%= hit.input.data.image.url %>"
              class="card-img-top"
              alt="Similar Image"
            />
            <div class="card-body">
              <h5 class="card-title">Score: <%= hit.score.toFixed(2) %></h5>
              <% if (hit.input.data.metadata) { %>
              <p class="card-text">
                <strong>Name:</strong> <%= hit.input.data.metadata.name %>
              </p>
              <p class="card-text">
                <strong>Category:</strong> <%= hit.input.data.metadata.category
                %>
              </p>
              <% } %>
            </div>
          </div>
        </div>
        <% }) %>
      </div>
      <% } %>

      <div class="note-box">
        <p>
          Please note that when a user uploads an image to find similar matches,
          the image is first uploaded to AWS S3 and then seeded into the
          Clarifai endpoint. Since the uploaded image is now part of the
          dataset, the application currently returns the same image as a match.
          Advanced similarity search features are not available under the
          Clarifai API free tier.
        </p>
      </div>

      <div class="text-center mt-4">
        <a href="/" class="btn btn-outline-primary btn-lg">Search Again</a>
      </div>

      <div class="text-center mt-5">
        <h3>Explore My Live Project</h3>
        <p>
          Check out my live project&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
          <a
            href="https://buy-and-sell-project.onrender.com"
            class="buy-sell-link"
            >Buy And Sell</a
          >
        </p>
      </div>
    </div>

    <!-- ✅ Footer -->
    <div class="footer">
      <p>&copy; 2025 Visual Product Matcher. All rights reserved.</p>
    </div>

    <!-- ✅ Bootstrap JS Bundle -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
  </body>
</html>
